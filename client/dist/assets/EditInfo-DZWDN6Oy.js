import{r as a,z as A,j as e,T as I,J as E,aq as D,A as S,L as T,s as d,t as i,O as w,v as j,ar as B,B as V,g as M,u as k,as as F,d as O,D as U}from"./index-BBXadzZ0.js";import{H as N}from"./Header-Ciq_Nrm5.js";import"./RankingTemplate-tw12TGph.js";import"./Title.styled-d_6YcK5y.js";import{G as z,S as P}from"./GeneralTab-DCqAMhSL.js";import{B as R}from"./ButtomPositionModal-Byo7j5tV.js";import"./Box-D0Xa-Rvs.js";import"./Box.styled-DN2A2xhE.js";import"./Rank.styled-BKFXWbYV.js";import"./Card.styled-BRygyNW9.js";import"./icon_arrow_right_small-ZUMzZ4ew.js";import"./SectionContainer-CGhBODQp.js";import"./WindowInfinityScrollContainer-81HpgYqX.js";import"./tab-CpR-np10.js";import"./icon_arrow_next-8svfqn2K.js";import"./NonData-DJp1MxrL.js";import"./Modal-3Qb9nTYM.js";function L({isOpen:n=!1,isClose:u,setMobileAuthValues:h}){const[m,x]=a.useState(!1),[l,p]=a.useState({}),[f,y]=a.useState(!0),{openModal:c}=A(),g=r=>{const{result:t,resultMessage:s}=r;if(t.userCheck===1){c({text:"이미 등록된 휴대폰 번호입니다."});return}c({text:"인증번호가 전송 되었습니다."}),x(!0)},C=({request:r,result:t,resultCode:s,resultMessage:o})=>{if(s!=200)return c({text:"오류가 발생했습니다. 잠시후에 다시 시도해주세요."});if(t.data===null){c({text:"인증되었습니다."}),p({...r,userPhoneNo:r.phone}),y(!1);return}c({text:o})},b=()=>{h(l),u()};return e.jsxs(R,{isOpen:n,children:[e.jsx(I,{size:20,children:"휴대폰 인증 "}),e.jsx(E,{initialValues:{...D.initialValues,type:"signup"},enableReinitialize:!0,validationSchema:D.schema,onSubmit:async(r,{setSubmitting:t})=>{try{const s=await S.requestSMSCode(r);g(s)}catch(s){console.error("submit failed:",s)}finally{t(!1)}},children:({isSubmitting:r,resetForm:t})=>e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:[e.jsxs(d,{style:{marginTop:"4rem"},children:[e.jsx(i,{type:"hidden",name:"type"}),e.jsx(i,{name:"userNm",placeholder:"이름"}),e.jsx(w,{telName:"mobileCarrier",phoneName:"phone"})]}),e.jsx(j,{type:"submit",theme:"revers",height:54,style:{marginBottom:"1rem"},children:m?"인증번호 재요청":"인증번호 요청"}),m&&e.jsx(B,{serviceAPI:S.verifyMembershipWithId,nextHandler:C}),e.jsxs(V,{style:{paddingTop:"2rem",borderTop:"1px dashed #c8c8c8c8"},children:[e.jsx(j,{onClick:()=>{u(),t()},theme:"sub",style:{flex:1},children:"취소"}),e.jsx(j,{disabled:f,onClick:()=>{b(),t()},style:{flex:1},children:"변경"})]})]}),r&&e.jsx(M,{})]})})]})}function q({userData:n}){const{changeUserDatas:u}=S,{initialValues:h,schema:m}=F,[x,l]=a.useState(!1),[p,f]=a.useState(!1),[y,c]=k(u),[g,C]=a.useState({}),{openModal:b}=A(),r=async t=>{if(!y)try{const s=await c(t),{resultCode:o,resultMessage:v}=s;if(o!=200){b({text:v});return}b({text:"정보가 변경되었습니다"})}catch(s){console.error(s)}};return e.jsxs(e.Fragment,{children:[e.jsx(E,{initialValues:{...h,...n,...g},enableReinitialize:!0,validationSchema:m,onSubmit:async(t,{setSubmitting:s})=>{try{await r(t)}catch(o){console.error("submit failed:",o)}finally{s(!1)}},children:({isSubmitting:t,setFieldValue:s,values:o})=>e.jsxs(T,{children:[e.jsx(d,{onClick:()=>console.log(o,"values"),children:e.jsx(i,{name:"userId",readonly:!0})}),e.jsxs(d,{children:[e.jsx(i,{type:"password",name:"userPw",placeholder:"비밀번호 변경"}),e.jsx(i,{type:"password",name:"userPwConfirm",placeholder:"비밀번호 확인"}),e.jsx("span",{style:{fontSize:"1.4rem",color:"#878787"},children:"영문, 숫자, 특수기호를 포함한 8~16자리"})]}),e.jsx(d,{children:e.jsx(i,{type:"text",name:"userNm",placeholder:"이름",readonly:!0})}),e.jsxs(d,{col:2,children:[e.jsx(i,{type:"text",name:"userPhoneNo",placeholder:"전화번호",readonly:!0}),e.jsx(j,{onClick:()=>f(!0),children:"전화번호 변경"})]}),e.jsx(d,{children:e.jsx(i,{type:"text",name:"userEmail",placeholder:"이메일"})}),e.jsx(d,{style:{borderTop:"1px solid #EAEAEA",paddingTop:"2rem"},children:e.jsx(z,{setIsOpen:l,userAgeCd:o.userAgeCd,setFieldValue:s})}),e.jsx(V,{children:e.jsx(j,{type:"submit",children:"회원정보 수정"})}),e.jsx(P,{isOpen:x,isClose:l,setFieldValue:s}),(t||y)&&e.jsx(M,{})]})}),e.jsx(L,{isOpen:p,isClose:()=>f(!1),setMobileAuthValues:C})]})}function H({userData:n={}}){return e.jsxs(e.Fragment,{children:[e.jsx(N,{backButton:!0,title:"회원정보수정",subMenu:!1}),e.jsx(O,{mode:"center",children:e.jsx(U,{maxWidth:500,children:e.jsxs("div",{children:[e.jsx(I,{size:24,color:"#111",style:{margin:"2rem 0 3rem"},children:"회원정보"}),e.jsx(q,{userData:n})]})})})]})}function ie(){const[n,u]=k(S.userInfo),[h,m]=a.useState({});a.useEffect(()=>{x()},[]);const x=a.useCallback(async()=>{if(!n)try{const p=(await u()).result;m(p)}catch(l){console.error(l)}},[h]);return e.jsxs(e.Fragment,{children:[e.jsx(H,{userData:h.data}),n&&e.jsx(M,{})]})}export{ie as default};
