import{a as B,j as e,T as h,N as j,n as m,M as A,b as _,c as E,u as f,r,d as U,Q as N,e as I,R as F,i as S,$ as H,S as W,B as M,f as z,A as y,g as G}from"./index-BBXadzZ0.js";import{S as K,a as O,b as V,c as $,d as C,e as q,G as Q,f as Z,g as Y,h as J,i as X,j as ee,k as se,l as te,m as ae,T as ne,U as re}from"./Rank.styled-BKFXWbYV.js";import{S as g}from"./SectionContainer-CGhBODQp.js";import"./Title.styled-d_6YcK5y.js";import{S as k,C as w,c as oe,g as ie}from"./Card.styled-BRygyNW9.js";import{H as ce}from"./Header-Ciq_Nrm5.js";import{B as D}from"./Box-D0Xa-Rvs.js";import"./Box.styled-DN2A2xhE.js";import{C as le}from"./CircularGauge-COGIBE8Y.js";import{R as de}from"./tab-CpR-np10.js";import{W as ue,R as pe}from"./rankService-B9-Y0ZJ9.js";import{B as he}from"./ButtomPositionModal-Byo7j5tV.js";import"./icon_arrow_right_small-ZUMzZ4ew.js";const xe=()=>B.get("/api/setting/popup/use"),ge="/assets/visual_quiz_imagex2-DavuZp0k.png";function T({count:s="",total:t="",unit:a=""}){return e.jsxs(K,{children:[e.jsx(O,{children:s})," / 총 ",t,a]})}function me({solveRightNo:s,solveNo:t}){const a=oe(s,t);return e.jsxs(D,{shadow:!0,children:[e.jsx(k,{icon:!1,children:e.jsx(h,{size:20,children:"정답문제"})}),e.jsx(w,{children:e.jsx(le,{value:a,maxValue:100,strokeWidth:10,color:"#ff5722"})}),e.jsx(T,{count:s,total:t,unit:"문제"})]})}const je="/assets/coin_image-iW57IuaR.png";function fe({stampNo:s,allStampNo:t}){return e.jsx(D,{shadow:!0,children:e.jsxs(j,{to:m[A].path,children:[e.jsx(k,{children:e.jsx(h,{size:20,children:"획득 스탬프"})}),e.jsx(w,{children:e.jsx("img",{src:je,alt:""})}),e.jsx(T,{count:s,total:t,unit:"스탬프"})]})})}function ke({solveRightNo:s=0,solveNo:t=0,stampNo:a=0,allStampNo:n=0}){return e.jsxs(V,{children:[e.jsx(me,{solveRightNo:s,solveNo:t}),e.jsx(fe,{stampNo:a,allStampNo:n})]})}function Se({level:s=1,initialLevelUpPoint:t,accruedPoint:a=0,levelUpPoint:n=0}){const o=t*s-a,i=t-o,c=ie(i,t);return e.jsxs($,{bgColor:C.secondary[100],children:[e.jsxs(q,{children:[e.jsx(_,{weight:500,color:"#707070",children:"레벨 업 포인트"}),e.jsxs(E,{color:C.primary[400],weight:700,children:[c,"%"]})]}),e.jsx(Q,{value:c,icon:null}),e.jsxs(Z,{children:[o," 포인트 모으면 레벨 UP!"]})]})}const ye="/assets/icon_trophy-C9iu3PEN.svg";function Ce({rank:s=1,schoolNm:t="-"}){return e.jsxs(Y,{children:[e.jsx(J,{rank:s}),e.jsxs(X,{rank:s,children:[e.jsxs(ee,{children:[s,"등"]}),e.jsx(se,{children:t}),s===1&&e.jsx(te,{src:ye,alt:"트로피 이미지"})]})]})}function Re({rankDatas:s=[]}){const t=[...s];for(;t.length<=3;)t.push(null);const a=[{...t[1],rank:2},{...t[0],rank:1},{...t[2],rank:3}];return e.jsx(ae,{children:a.map((n,o)=>e.jsx(Ce,{rank:n?n.rank:o+1,schoolNm:n.schoolNm},o))})}function we({}){const[s,t]=f(pe.weekRank),[a,n]=r.useState(ue),[o,i]=r.useState([]);r.useEffect(()=>{c()},[a]);const c=r.useCallback(async()=>{if(!s)try{const u=(await t({...a,pageUnit:3})).result;i(u.data)}catch(d){console.error(d)}},[a]),p=(d="this")=>{n(u=>({...u,searchWeek:d}))};return e.jsxs(e.Fragment,{children:[e.jsx(ne,{onClick:p,tabList:de}),e.jsx(Re,{rankDatas:o,isLoading:s})]})}function De({userData:s={},initialLevelUpPoint:t=0}){const{userNm:a,accruedPoint:n,level:o,levelUpPoint:i,solveRightNo:c,solveNo:p,stampNo:d,allStampNo:u}={...re,...s};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{}),e.jsxs(U,{children:[e.jsx(g,{children:e.jsx(j,{to:m[N].path,style:{display:"block",textAlign:"center"},children:e.jsx("img",{src:ge,alt:"학습 전 개념부터 정리해요! 미디어 리터러시 문제풀자!"})})}),e.jsxs(g,{paddingTop:30,paddingBt:30,children:[e.jsxs(h,{size:20,weight:400,children:["현재 ",a,"님의 ",e.jsx("br",{})," ",e.jsx("b",{children:" 누적 포인트"})]}),e.jsx(Se,{level:o,initialLevelUpPoint:t,accruedPoint:n,levelUpPoint:i}),e.jsx(ke,{solveRightNo:c,solveNo:p,stampNo:d,allStampNo:u})]}),e.jsxs(g,{bg:I.secondary[100],paddingTop:30,paddingBt:30,children:[e.jsx(k,{to:m[F].path,children:e.jsxs(h,{size:20,weight:400,children:["현재 ",a,"님의 ",e.jsx("br",{})," ",e.jsx("b",{children:"참여학교 랭킹"})]})}),e.jsx(we,{})]})]})]})}const Te={popupList:async()=>{try{const s=await xe(),t=S(s),{result:a}=t.data;return a.data}catch(s){const{response:t}=s;throw console.error("quizCategory failed:",s),S(t.data),s}}},be={dots:!1,infinite:!0,speed:500,autoplay:!0,fade:!1,arrows:!1,slidesToShow:1,slidesToScroll:1},Le=void 0,Pe=()=>{const s=r.useRef(null),[t,a]=f(Te.popupList),[n,o]=r.useState([]),[i,c]=r.useState(!1),[p,d]=r.useState(1);r.useEffect(()=>{u()},[]),r.useEffect(()=>{P()},[i]);const u=r.useCallback(async()=>{if(!t)try{const l=await a(),x=localStorage.getItem("hidePopupToday"),v=new Date().toLocaleDateString();x!==v&&l.length&&c(!0),o(l)}catch(l){console.error(l)}},[]),b=()=>{const l=new Date().toLocaleDateString();localStorage.setItem("hidePopupToday",l),c(!1)},L=()=>{c(!1)},P=()=>{if(i){document.body.style.overflow="hidden";return}document.body.style.overflow="auto"};return i?e.jsx(he,{isOpen:!0,style:{paddingBottom:"1rem"},children:t?e.jsx("div",{style:{textAlign:"center",padding:"5rem 0"},children:e.jsx(H,{visible:!0,height:"60",width:"60",color:"#FFD43B",strokeColor:"#FF881B",strokeWidth:"5",animationDuration:"0.75"})}):e.jsxs(e.Fragment,{children:[e.jsx(W,{ref:s,...be,afterChange:l=>d(l+1),children:n.map((l,x)=>e.jsx(j,{to:l.linkUrl,target:"_self",onClick:()=>document.body.style.overflow="auto",children:e.jsx("img",{src:Le+l.imageLink,alt:l.popupNm,style:{margin:"0 auto"}})},x))}),e.jsx("div",{style:{marginTop:"1rem",textAlign:"center"},children:e.jsxs("span",{children:[p," / ",n.length]})}),e.jsxs(M,{children:[e.jsx(R,{style:{flex:1},onClick:b,children:"오늘 하루 보지 않기"}),e.jsx(R,{style:{flex:1},onClick:L,children:"닫기"})]})]})}):null},R=z("button")`
  flex: 1;
  padding: 1rem;
  &:active {
    opacity: 0.7;
    transform: translate(1px, 1px);
    background-color: rgba(194, 192, 193, 0.25);
  }
`;function Ge(){const[s,t]=f(y.userDatas),[a,n]=r.useState({});r.useEffect(()=>{o()},[]);const o=r.useCallback(async()=>{if(!s)try{await y.attendance();const c=(await t()).result;n(c)}catch(i){console.error(i)}},[a]);return e.jsxs(e.Fragment,{children:[e.jsx(De,{userData:a.data,initialLevelUpPoint:a.levelUpPoint}),e.jsx(Pe,{}),s&&e.jsx(G,{})]})}export{Ge as default};
